<!DOCTYPE HTML>
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc -->
<title>StoreBufferService (venice API)</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link rel="stylesheet" type="text/css" href="../../../../../stylesheet.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../../jquery/jquery-ui.min.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../../jquery-ui.overrides.css" title="Style">
<script type="text/javascript" src="../../../../../script.js"></script>
<script type="text/javascript" src="../../../../../jquery/jszip/dist/jszip.min.js"></script>
<script type="text/javascript" src="../../../../../jquery/jszip-utils/dist/jszip-utils.min.js"></script>
<!--[if IE]>
<script type="text/javascript" src="../../../../../jquery/jszip-utils/dist/jszip-utils-ie.min.js"></script>
<![endif]-->
<script type="text/javascript" src="../../../../../jquery/jquery-3.6.1.min.js"></script>
<script type="text/javascript" src="../../../../../jquery/jquery-ui.min.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="StoreBufferService (venice API)";
        }
    }
    catch(err) {
    }
//-->
var data = {"i0":10,"i1":10,"i2":10,"i3":10,"i4":10,"i5":10,"i6":10,"i7":10,"i8":10,"i9":10,"i10":10};
var tabs = {65535:["t0","All Methods"],2:["t2","Instance Methods"],8:["t4","Concrete Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
var pathtoroot = "../../../../../";
var useModuleDirectories = true;
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<header role="banner">
<nav role="navigation">
<div class="fixedNav">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a id="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a id="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../../allclasses.html">All&nbsp;Classes</a></li>
</ul>
<ul class="navListSearch">
<li><label for="search">SEARCH:</label>
<input type="text" id="search" value="search" disabled="disabled">
<input type="reset" id="reset" value="reset" disabled="disabled">
</li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested.class.summary">Nested</a>&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a id="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
</div>
<div class="navPadding">&nbsp;</div>
<script type="text/javascript"><!--
$('.navPadding').css('padding-top', $('.fixedNav').css("height"));
//-->
</script>
</nav>
</header>
<!-- ======== START OF CLASS DATA ======== -->
<main role="main">
<div class="header">
<div class="subTitle"><span class="packageLabelInType">Package</span>&nbsp;<a href="package-summary.html">com.linkedin.davinci.kafka.consumer</a></div>
<h2 title="Class StoreBufferService" class="title">Class StoreBufferService</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li>java.lang.Object</li>
<li>
<ul class="inheritance">
<li><a href="../../../venice/service/AbstractVeniceService.html" title="class in com.linkedin.venice.service">com.linkedin.venice.service.AbstractVeniceService</a></li>
<li>
<ul class="inheritance">
<li><a href="AbstractStoreBufferService.html" title="class in com.linkedin.davinci.kafka.consumer">com.linkedin.davinci.kafka.consumer.AbstractStoreBufferService</a></li>
<li>
<ul class="inheritance">
<li>com.linkedin.davinci.kafka.consumer.StoreBufferService</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<dl>
<dt>All Implemented Interfaces:</dt>
<dd><code>java.io.Closeable</code>, <code>java.lang.AutoCloseable</code></dd>
</dl>
<hr>
<pre>public class <span class="typeNameLabel">StoreBufferService</span>
extends <a href="AbstractStoreBufferService.html" title="class in com.linkedin.davinci.kafka.consumer">AbstractStoreBufferService</a></pre>
<div class="block">This class is serving as a <a href="../../../venice/pubsub/api/PubSubMessage.html" title="interface in com.linkedin.venice.pubsub.api"><code>PubSubMessage</code></a> buffer with an accompanying pool of drainer threads. The drainers
 pull records out of the buffer and delegate the persistence and validation to the appropriate <a href="StoreIngestionTask.html" title="class in com.linkedin.davinci.kafka.consumer"><code>StoreIngestionTask</code></a>.

 High-level idea:
 1. <a href="StoreBufferService.html" title="class in com.linkedin.davinci.kafka.consumer"><code>StoreBufferService</code></a> will be maintaining a fixed number (configurable) of <code>StoreBufferService.StoreBufferDrainer</code> pool;
 2. For each <code>StoreBufferService.StoreBufferDrainer</code>, there is a corresponding <code>BlockingQueue</code>, which will buffer <code>StoreBufferService.QueueNode</code>;
 3. All the records belonging to the same topic+partition will be allocated to the same drainer thread, otherwise DIV will fail;
 4. The logic to assign topic+partition to drainer, please check <a href="#getDrainerIndexForConsumerRecord(com.linkedin.venice.pubsub.api.PubSubMessage,int)"><code>getDrainerIndexForConsumerRecord(PubSubMessage, int)</code></a>;
 5. There is still a thread executing <a href="StoreIngestionTask.html" title="class in com.linkedin.davinci.kafka.consumer"><code>StoreIngestionTask</code></a> for each topic, which will handle admin actions, such
 as subscribe, unsubscribe, kill and so on, and also poll consumer records from Kafka and put them into <a href="#blockingQueueArr"><code>blockingQueueArr</code></a>
 maintained by <a href="StoreBufferService.html" title="class in com.linkedin.davinci.kafka.consumer"><code>StoreBufferService</code></a>;

 For now, the assumption is that one-consumer-polling-thread should be fast enough to catch up with Kafka MM replication,
 and data processing is the slowest part. If we find that polling is also slow later on, we may consider to adopt a consumer
 thread pool to speed up polling from local Kafka brokers.</div>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ======== NESTED CLASS SUMMARY ======== -->
<section>
<ul class="blockList">
<li class="blockList"><a id="nested.class.summary">
<!--   -->
</a>
<h3>Nested Class Summary</h3>
<ul class="blockList">
<li class="blockList"><a id="nested.classes.inherited.from.class.com.linkedin.venice.service.AbstractVeniceService">
<!--   -->
</a>
<h3>Nested classes/interfaces inherited from class&nbsp;com.linkedin.venice.service.<a href="../../../venice/service/AbstractVeniceService.html" title="class in com.linkedin.venice.service">AbstractVeniceService</a></h3>
<code><a href="../../../venice/service/AbstractVeniceService.ServiceState.html" title="enum in com.linkedin.venice.service">AbstractVeniceService.ServiceState</a></code></li>
</ul>
</li>
</ul>
</section>
<!-- =========== FIELD SUMMARY =========== -->
<section>
<ul class="blockList">
<li class="blockList"><a id="field.summary">
<!--   -->
</a>
<h3>Field Summary</h3>
<ul class="blockList">
<li class="blockList"><a id="fields.inherited.from.class.com.linkedin.venice.service.AbstractVeniceService">
<!--   -->
</a>
<h3>Fields inherited from class&nbsp;com.linkedin.venice.service.<a href="../../../venice/service/AbstractVeniceService.html" title="class in com.linkedin.venice.service">AbstractVeniceService</a></h3>
<code><a href="../../../venice/service/AbstractVeniceService.html#logger">logger</a>, <a href="../../../venice/service/AbstractVeniceService.html#serviceState">serviceState</a></code></li>
</ul>
</li>
</ul>
</section>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<section>
<ul class="blockList">
<li class="blockList"><a id="constructor.summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="memberSummary">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Constructor</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tr class="altColor">
<th class="colConstructorName" scope="row"><code><span class="memberNameLink"><a href="#%3Cinit%3E(int,long,long,boolean,com.linkedin.davinci.stats.StoreBufferServiceStats)">StoreBufferService</a></span>&#8203;(int&nbsp;drainerNum,
                  long&nbsp;bufferCapacityPerDrainer,
                  long&nbsp;bufferNotifyDelta,
                  boolean&nbsp;queueLeaderWrites,
                  <a href="../../stats/StoreBufferServiceStats.html" title="class in com.linkedin.davinci.stats">StoreBufferServiceStats</a>&nbsp;stats)</code></th>
<td class="colLast">
<div class="block">Constructor for testing</div>
</td>
</tr>
<tr class="rowColor">
<th class="colConstructorName" scope="row"><code><span class="memberNameLink"><a href="#%3Cinit%3E(int,long,long,boolean,io.tehuti.metrics.MetricsRepository,boolean)">StoreBufferService</a></span>&#8203;(int&nbsp;drainerNum,
                  long&nbsp;bufferCapacityPerDrainer,
                  long&nbsp;bufferNotifyDelta,
                  boolean&nbsp;queueLeaderWrites,
                  io.tehuti.metrics.MetricsRepository&nbsp;metricsRepository,
                  boolean&nbsp;sorted)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
</table>
</li>
</ul>
</section>
<!-- ========== METHOD SUMMARY =========== -->
<section>
<ul class="blockList">
<li class="blockList"><a id="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t2" class="tableTab"><span><a href="javascript:show(2);">Instance Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t4" class="tableTab"><span><a href="javascript:show(8);">Concrete Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colSecond" scope="col">Method</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#drainBufferedRecordsFromTopicPartition(com.linkedin.venice.pubsub.api.PubSubTopicPartition)">drainBufferedRecordsFromTopicPartition</a></span>&#8203;(<a href="../../../venice/pubsub/api/PubSubTopicPartition.html" title="interface in com.linkedin.venice.pubsub.api">PubSubTopicPartition</a>&nbsp;topicPartition)</code></th>
<td class="colLast">
<div class="block">This function is used to drain all the records for the specified topic + partition.</div>
</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code>protected <a href="MemoryBoundBlockingQueue.html" title="class in com.linkedin.davinci.kafka.consumer">MemoryBoundBlockingQueue</a>&lt;com.linkedin.davinci.kafka.consumer.StoreBufferService.QueueNode&gt;</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getDrainerForConsumerRecord(com.linkedin.venice.pubsub.api.PubSubMessage,int)">getDrainerForConsumerRecord</a></span>&#8203;(<a href="../../../venice/pubsub/api/PubSubMessage.html" title="interface in com.linkedin.venice.pubsub.api">PubSubMessage</a>&lt;<a href="../../../venice/message/KafkaKey.html" title="class in com.linkedin.venice.message">KafkaKey</a>,&#8203;<a href="../../../venice/kafka/protocol/KafkaMessageEnvelope.html" title="class in com.linkedin.venice.kafka.protocol">KafkaMessageEnvelope</a>,&#8203;java.lang.Long&gt;&nbsp;consumerRecord,
                           int&nbsp;subPartition)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr id="i2" class="altColor">
<td class="colFirst"><code>protected int</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getDrainerIndexForConsumerRecord(com.linkedin.venice.pubsub.api.PubSubMessage,int)">getDrainerIndexForConsumerRecord</a></span>&#8203;(<a href="../../../venice/pubsub/api/PubSubMessage.html" title="interface in com.linkedin.venice.pubsub.api">PubSubMessage</a>&lt;<a href="../../../venice/message/KafkaKey.html" title="class in com.linkedin.venice.message">KafkaKey</a>,&#8203;<a href="../../../venice/kafka/protocol/KafkaMessageEnvelope.html" title="class in com.linkedin.venice.kafka.protocol">KafkaMessageEnvelope</a>,&#8203;java.lang.Long&gt;&nbsp;consumerRecord,
                                int&nbsp;subPartition)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr id="i3" class="rowColor">
<td class="colFirst"><code>long</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getMaxMemoryUsagePerDrainer()">getMaxMemoryUsagePerDrainer</a></span>()</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr id="i4" class="altColor">
<td class="colFirst"><code>long</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getMinMemoryUsagePerDrainer()">getMinMemoryUsagePerDrainer</a></span>()</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr id="i5" class="rowColor">
<td class="colFirst"><code>long</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getTotalMemoryUsage()">getTotalMemoryUsage</a></span>()</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr id="i6" class="altColor">
<td class="colFirst"><code>long</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getTotalRemainingMemory()">getTotalRemainingMemory</a></span>()</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr id="i7" class="rowColor">
<td class="colFirst"><code>protected void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#internalDrainBufferedRecordsFromTopicPartition(com.linkedin.venice.pubsub.api.PubSubTopicPartition,int,int)">internalDrainBufferedRecordsFromTopicPartition</a></span>&#8203;(<a href="../../../venice/pubsub/api/PubSubTopicPartition.html" title="interface in com.linkedin.venice.pubsub.api">PubSubTopicPartition</a>&nbsp;topicPartition,
                                              int&nbsp;retryNum,
                                              int&nbsp;sleepIntervalInMS)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr id="i8" class="altColor">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#putConsumerRecord(com.linkedin.venice.pubsub.api.PubSubMessage,com.linkedin.davinci.kafka.consumer.StoreIngestionTask,com.linkedin.davinci.kafka.consumer.LeaderProducedRecordContext,int,java.lang.String,long)">putConsumerRecord</a></span>&#8203;(<a href="../../../venice/pubsub/api/PubSubMessage.html" title="interface in com.linkedin.venice.pubsub.api">PubSubMessage</a>&lt;<a href="../../../venice/message/KafkaKey.html" title="class in com.linkedin.venice.message">KafkaKey</a>,&#8203;<a href="../../../venice/kafka/protocol/KafkaMessageEnvelope.html" title="class in com.linkedin.venice.kafka.protocol">KafkaMessageEnvelope</a>,&#8203;java.lang.Long&gt;&nbsp;consumerRecord,
                 <a href="StoreIngestionTask.html" title="class in com.linkedin.davinci.kafka.consumer">StoreIngestionTask</a>&nbsp;ingestionTask,
                 <a href="LeaderProducedRecordContext.html" title="class in com.linkedin.davinci.kafka.consumer">LeaderProducedRecordContext</a>&nbsp;leaderProducedRecordContext,
                 int&nbsp;subPartition,
                 java.lang.String&nbsp;kafkaUrl,
                 long&nbsp;beforeProcessingRecordTimestampNs)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr id="i9" class="rowColor">
<td class="colFirst"><code>boolean</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#startInner()">startInner</a></span>()</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr id="i10" class="altColor">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#stopInner()">stopInner</a></span>()</code></th>
<td class="colLast">&nbsp;</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a id="methods.inherited.from.class.com.linkedin.venice.service.AbstractVeniceService">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;com.linkedin.venice.service.<a href="../../../venice/service/AbstractVeniceService.html" title="class in com.linkedin.venice.service">AbstractVeniceService</a></h3>
<code><a href="../../../venice/service/AbstractVeniceService.html#close()">close</a>, <a href="../../../venice/service/AbstractVeniceService.html#getName()">getName</a>, <a href="../../../venice/service/AbstractVeniceService.html#isRunning()">isRunning</a>, <a href="../../../venice/service/AbstractVeniceService.html#start()">start</a>, <a href="../../../venice/service/AbstractVeniceService.html#stop()">stop</a></code></li>
</ul>
<ul class="blockList">
<li class="blockList"><a id="methods.inherited.from.class.java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.Object</h3>
<code>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</code></li>
</ul>
</li>
</ul>
</section>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<section>
<ul class="blockList">
<li class="blockList"><a id="constructor.detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a id="&lt;init&gt;(int,long,long,boolean,io.tehuti.metrics.MetricsRepository,boolean)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>StoreBufferService</h4>
<pre>public&nbsp;StoreBufferService&#8203;(int&nbsp;drainerNum,
                          long&nbsp;bufferCapacityPerDrainer,
                          long&nbsp;bufferNotifyDelta,
                          boolean&nbsp;queueLeaderWrites,
                          io.tehuti.metrics.MetricsRepository&nbsp;metricsRepository,
                          boolean&nbsp;sorted)</pre>
</li>
</ul>
<a id="&lt;init&gt;(int,long,long,boolean,com.linkedin.davinci.stats.StoreBufferServiceStats)">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>StoreBufferService</h4>
<pre>public&nbsp;StoreBufferService&#8203;(int&nbsp;drainerNum,
                          long&nbsp;bufferCapacityPerDrainer,
                          long&nbsp;bufferNotifyDelta,
                          boolean&nbsp;queueLeaderWrites,
                          <a href="../../stats/StoreBufferServiceStats.html" title="class in com.linkedin.davinci.stats">StoreBufferServiceStats</a>&nbsp;stats)</pre>
<div class="block">Constructor for testing</div>
</li>
</ul>
</li>
</ul>
</section>
<!-- ============ METHOD DETAIL ========== -->
<section>
<ul class="blockList">
<li class="blockList"><a id="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a id="getDrainerForConsumerRecord(com.linkedin.venice.pubsub.api.PubSubMessage,int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getDrainerForConsumerRecord</h4>
<pre class="methodSignature">protected&nbsp;<a href="MemoryBoundBlockingQueue.html" title="class in com.linkedin.davinci.kafka.consumer">MemoryBoundBlockingQueue</a>&lt;com.linkedin.davinci.kafka.consumer.StoreBufferService.QueueNode&gt;&nbsp;getDrainerForConsumerRecord&#8203;(<a href="../../../venice/pubsub/api/PubSubMessage.html" title="interface in com.linkedin.venice.pubsub.api">PubSubMessage</a>&lt;<a href="../../../venice/message/KafkaKey.html" title="class in com.linkedin.venice.message">KafkaKey</a>,&#8203;<a href="../../../venice/kafka/protocol/KafkaMessageEnvelope.html" title="class in com.linkedin.venice.kafka.protocol">KafkaMessageEnvelope</a>,&#8203;java.lang.Long&gt;&nbsp;consumerRecord,
                                                                                                                                 int&nbsp;subPartition)</pre>
</li>
</ul>
<a id="getDrainerIndexForConsumerRecord(com.linkedin.venice.pubsub.api.PubSubMessage,int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getDrainerIndexForConsumerRecord</h4>
<pre class="methodSignature">protected&nbsp;int&nbsp;getDrainerIndexForConsumerRecord&#8203;(<a href="../../../venice/pubsub/api/PubSubMessage.html" title="interface in com.linkedin.venice.pubsub.api">PubSubMessage</a>&lt;<a href="../../../venice/message/KafkaKey.html" title="class in com.linkedin.venice.message">KafkaKey</a>,&#8203;<a href="../../../venice/kafka/protocol/KafkaMessageEnvelope.html" title="class in com.linkedin.venice.kafka.protocol">KafkaMessageEnvelope</a>,&#8203;java.lang.Long&gt;&nbsp;consumerRecord,
                                               int&nbsp;subPartition)</pre>
</li>
</ul>
<a id="putConsumerRecord(com.linkedin.venice.pubsub.api.PubSubMessage,com.linkedin.davinci.kafka.consumer.StoreIngestionTask,com.linkedin.davinci.kafka.consumer.LeaderProducedRecordContext,int,java.lang.String,long)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>putConsumerRecord</h4>
<pre class="methodSignature">public&nbsp;void&nbsp;putConsumerRecord&#8203;(<a href="../../../venice/pubsub/api/PubSubMessage.html" title="interface in com.linkedin.venice.pubsub.api">PubSubMessage</a>&lt;<a href="../../../venice/message/KafkaKey.html" title="class in com.linkedin.venice.message">KafkaKey</a>,&#8203;<a href="../../../venice/kafka/protocol/KafkaMessageEnvelope.html" title="class in com.linkedin.venice.kafka.protocol">KafkaMessageEnvelope</a>,&#8203;java.lang.Long&gt;&nbsp;consumerRecord,
                              <a href="StoreIngestionTask.html" title="class in com.linkedin.davinci.kafka.consumer">StoreIngestionTask</a>&nbsp;ingestionTask,
                              <a href="LeaderProducedRecordContext.html" title="class in com.linkedin.davinci.kafka.consumer">LeaderProducedRecordContext</a>&nbsp;leaderProducedRecordContext,
                              int&nbsp;subPartition,
                              java.lang.String&nbsp;kafkaUrl,
                              long&nbsp;beforeProcessingRecordTimestampNs)
                       throws java.lang.InterruptedException</pre>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="AbstractStoreBufferService.html#putConsumerRecord(com.linkedin.venice.pubsub.api.PubSubMessage,com.linkedin.davinci.kafka.consumer.StoreIngestionTask,com.linkedin.davinci.kafka.consumer.LeaderProducedRecordContext,int,java.lang.String,long)">putConsumerRecord</a></code>&nbsp;in class&nbsp;<code><a href="AbstractStoreBufferService.html" title="class in com.linkedin.davinci.kafka.consumer">AbstractStoreBufferService</a></code></dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.lang.InterruptedException</code></dd>
</dl>
</li>
</ul>
<a id="drainBufferedRecordsFromTopicPartition(com.linkedin.venice.pubsub.api.PubSubTopicPartition)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>drainBufferedRecordsFromTopicPartition</h4>
<pre class="methodSignature">public&nbsp;void&nbsp;drainBufferedRecordsFromTopicPartition&#8203;(<a href="../../../venice/pubsub/api/PubSubTopicPartition.html" title="interface in com.linkedin.venice.pubsub.api">PubSubTopicPartition</a>&nbsp;topicPartition)
                                            throws java.lang.InterruptedException</pre>
<div class="block">This function is used to drain all the records for the specified topic + partition.
 The reason is that we don't want overlap Kafka messages between two different subscriptions,
 which could introduce complicate dependencies in <a href="StoreIngestionTask.html" title="class in com.linkedin.davinci.kafka.consumer"><code>StoreIngestionTask</code></a>.</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="AbstractStoreBufferService.html#drainBufferedRecordsFromTopicPartition(com.linkedin.venice.pubsub.api.PubSubTopicPartition)">drainBufferedRecordsFromTopicPartition</a></code>&nbsp;in class&nbsp;<code><a href="AbstractStoreBufferService.html" title="class in com.linkedin.davinci.kafka.consumer">AbstractStoreBufferService</a></code></dd>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>topicPartition</code> - for which to drain buffer</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.lang.InterruptedException</code></dd>
</dl>
</li>
</ul>
<a id="internalDrainBufferedRecordsFromTopicPartition(com.linkedin.venice.pubsub.api.PubSubTopicPartition,int,int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>internalDrainBufferedRecordsFromTopicPartition</h4>
<pre class="methodSignature">protected&nbsp;void&nbsp;internalDrainBufferedRecordsFromTopicPartition&#8203;(<a href="../../../venice/pubsub/api/PubSubTopicPartition.html" title="interface in com.linkedin.venice.pubsub.api">PubSubTopicPartition</a>&nbsp;topicPartition,
                                                              int&nbsp;retryNum,
                                                              int&nbsp;sleepIntervalInMS)
                                                       throws java.lang.InterruptedException</pre>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.lang.InterruptedException</code></dd>
</dl>
</li>
</ul>
<a id="startInner()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>startInner</h4>
<pre class="methodSignature">public&nbsp;boolean&nbsp;startInner()</pre>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="../../../venice/service/AbstractVeniceService.html#startInner()">startInner</a></code>&nbsp;in class&nbsp;<code><a href="../../../venice/service/AbstractVeniceService.html" title="class in com.linkedin.venice.service">AbstractVeniceService</a></code></dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>true if the service is completely started,
         false if it is still starting asynchronously (in this case, it is the implementer's
         responsibility to set <a href="../../../venice/service/AbstractVeniceService.html#serviceState"><code>AbstractVeniceService.serviceState</code></a> to <a href="../../../venice/service/AbstractVeniceService.ServiceState.html#STARTED"><code>AbstractVeniceService.ServiceState.STARTED</code></a> upon
         completion of the async work).</dd>
</dl>
</li>
</ul>
<a id="stopInner()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>stopInner</h4>
<pre class="methodSignature">public&nbsp;void&nbsp;stopInner()
               throws java.lang.Exception</pre>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="../../../venice/service/AbstractVeniceService.html#stopInner()">stopInner</a></code>&nbsp;in class&nbsp;<code><a href="../../../venice/service/AbstractVeniceService.html" title="class in com.linkedin.venice.service">AbstractVeniceService</a></code></dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.lang.Exception</code></dd>
</dl>
</li>
</ul>
<a id="getTotalMemoryUsage()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getTotalMemoryUsage</h4>
<pre class="methodSignature">public&nbsp;long&nbsp;getTotalMemoryUsage()</pre>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="AbstractStoreBufferService.html#getTotalMemoryUsage()">getTotalMemoryUsage</a></code>&nbsp;in class&nbsp;<code><a href="AbstractStoreBufferService.html" title="class in com.linkedin.davinci.kafka.consumer">AbstractStoreBufferService</a></code></dd>
</dl>
</li>
</ul>
<a id="getTotalRemainingMemory()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getTotalRemainingMemory</h4>
<pre class="methodSignature">public&nbsp;long&nbsp;getTotalRemainingMemory()</pre>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="AbstractStoreBufferService.html#getTotalRemainingMemory()">getTotalRemainingMemory</a></code>&nbsp;in class&nbsp;<code><a href="AbstractStoreBufferService.html" title="class in com.linkedin.davinci.kafka.consumer">AbstractStoreBufferService</a></code></dd>
</dl>
</li>
</ul>
<a id="getMaxMemoryUsagePerDrainer()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getMaxMemoryUsagePerDrainer</h4>
<pre class="methodSignature">public&nbsp;long&nbsp;getMaxMemoryUsagePerDrainer()</pre>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="AbstractStoreBufferService.html#getMaxMemoryUsagePerDrainer()">getMaxMemoryUsagePerDrainer</a></code>&nbsp;in class&nbsp;<code><a href="AbstractStoreBufferService.html" title="class in com.linkedin.davinci.kafka.consumer">AbstractStoreBufferService</a></code></dd>
</dl>
</li>
</ul>
<a id="getMinMemoryUsagePerDrainer()">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>getMinMemoryUsagePerDrainer</h4>
<pre class="methodSignature">public&nbsp;long&nbsp;getMinMemoryUsagePerDrainer()</pre>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="AbstractStoreBufferService.html#getMinMemoryUsagePerDrainer()">getMinMemoryUsagePerDrainer</a></code>&nbsp;in class&nbsp;<code><a href="AbstractStoreBufferService.html" title="class in com.linkedin.davinci.kafka.consumer">AbstractStoreBufferService</a></code></dd>
</dl>
</li>
</ul>
</li>
</ul>
</section>
</li>
</ul>
</div>
</div>
</main>
<!-- ========= END OF CLASS DATA ========= -->
<footer role="contentinfo">
<nav role="navigation">
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a id="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a id="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../../allclasses.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested.class.summary">Nested</a>&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a id="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</nav>
</footer>
</body>
</html>
