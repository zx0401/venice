<!DOCTYPE HTML>
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc -->
<title>VeniceViewWriter (venice API)</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link rel="stylesheet" type="text/css" href="../../../../../stylesheet.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../../jquery/jquery-ui.min.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../../jquery-ui.overrides.css" title="Style">
<script type="text/javascript" src="../../../../../script.js"></script>
<script type="text/javascript" src="../../../../../jquery/jszip/dist/jszip.min.js"></script>
<script type="text/javascript" src="../../../../../jquery/jszip-utils/dist/jszip-utils.min.js"></script>
<!--[if IE]>
<script type="text/javascript" src="../../../../../jquery/jszip-utils/dist/jszip-utils-ie.min.js"></script>
<![endif]-->
<script type="text/javascript" src="../../../../../jquery/jquery-3.6.1.min.js"></script>
<script type="text/javascript" src="../../../../../jquery/jquery-ui.min.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="VeniceViewWriter (venice API)";
        }
    }
    catch(err) {
    }
//-->
var data = {"i0":10,"i1":10};
var tabs = {65535:["t0","All Methods"],2:["t2","Instance Methods"],8:["t4","Concrete Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
var pathtoroot = "../../../../../";
var useModuleDirectories = true;
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<header role="banner">
<nav role="navigation">
<div class="fixedNav">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a id="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a id="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../../allclasses.html">All&nbsp;Classes</a></li>
</ul>
<ul class="navListSearch">
<li><label for="search">SEARCH:</label>
<input type="text" id="search" value="search" disabled="disabled">
<input type="reset" id="reset" value="reset" disabled="disabled">
</li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a id="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
</div>
<div class="navPadding">&nbsp;</div>
<script type="text/javascript"><!--
$('.navPadding').css('padding-top', $('.fixedNav').css("height"));
//-->
</script>
</nav>
</header>
<!-- ======== START OF CLASS DATA ======== -->
<main role="main">
<div class="header">
<div class="subTitle"><span class="packageLabelInType">Package</span>&nbsp;<a href="package-summary.html">com.linkedin.davinci.store.view</a></div>
<h2 title="Class VeniceViewWriter" class="title">Class VeniceViewWriter</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li>java.lang.Object</li>
<li>
<ul class="inheritance">
<li><a href="../../../venice/views/VeniceView.html" title="class in com.linkedin.venice.views">com.linkedin.venice.views.VeniceView</a></li>
<li>
<ul class="inheritance">
<li>com.linkedin.davinci.store.view.VeniceViewWriter</li>
</ul>
</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<dl>
<dt>Direct Known Subclasses:</dt>
<dd><code><a href="ChangeCaptureViewWriter.html" title="class in com.linkedin.davinci.store.view">ChangeCaptureViewWriter</a></code></dd>
</dl>
<hr>
<pre>public abstract class <span class="typeNameLabel">VeniceViewWriter</span>
extends <a href="../../../venice/views/VeniceView.html" title="class in com.linkedin.venice.views">VeniceView</a></pre>
<div class="block">This class is kept separate from the VeniceView class to not leak certain concepts that
 currently exclusively reside in the server to other components. This class is created per
 <a href="../../kafka/consumer/LeaderFollowerStoreIngestionTask.html" title="class in com.linkedin.davinci.kafka.consumer"><code>LeaderFollowerStoreIngestionTask</code></a> per view and is
 invoked to processRecords in the <a href="../../kafka/consumer/ActiveActiveStoreIngestionTask.html" title="class in com.linkedin.davinci.kafka.consumer"><code>ActiveActiveStoreIngestionTask</code></a>
 as it's consumed from Kafka and after MergeConflict resolution has run. It's then invoked prior
 to committing to local persistent storage or local VT production in order to keep integrity of
 the data in various failure scenarios. This implies that repeat calls on the same data for
 processRecords can happen and there should be some protection from that being an issue in different
 view implementations.</div>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- =========== FIELD SUMMARY =========== -->
<section>
<ul class="blockList">
<li class="blockList"><a id="field.summary">
<!--   -->
</a>
<h3>Field Summary</h3>
<ul class="blockList">
<li class="blockList"><a id="fields.inherited.from.class.com.linkedin.venice.views.VeniceView">
<!--   -->
</a>
<h3>Fields inherited from class&nbsp;com.linkedin.venice.views.<a href="../../../venice/views/VeniceView.html" title="class in com.linkedin.venice.views">VeniceView</a></h3>
<code><a href="../../../venice/views/VeniceView.html#props">props</a>, <a href="../../../venice/views/VeniceView.html#store">store</a>, <a href="../../../venice/views/VeniceView.html#viewParameters">viewParameters</a></code></li>
</ul>
</li>
</ul>
</section>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<section>
<ul class="blockList">
<li class="blockList"><a id="constructor.summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="memberSummary">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Constructor</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tr class="altColor">
<th class="colConstructorName" scope="row"><code><span class="memberNameLink"><a href="#%3Cinit%3E(com.linkedin.davinci.config.VeniceConfigLoader,com.linkedin.venice.meta.Store,org.apache.avro.Schema,java.util.Map)">VeniceViewWriter</a></span>&#8203;(<a href="../../config/VeniceConfigLoader.html" title="class in com.linkedin.davinci.config">VeniceConfigLoader</a>&nbsp;props,
                <a href="../../../venice/meta/Store.html" title="interface in com.linkedin.venice.meta">Store</a>&nbsp;store,
                org.apache.avro.Schema&nbsp;keySchema,
                java.util.Map&lt;java.lang.String,&#8203;java.lang.String&gt;&nbsp;extraViewParameters)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
</table>
</li>
</ul>
</section>
<!-- ========== METHOD SUMMARY =========== -->
<section>
<ul class="blockList">
<li class="blockList"><a id="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t2" class="tableTab"><span><a href="javascript:show(2);">Instance Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t4" class="tableTab"><span><a href="javascript:show(8);">Concrete Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colSecond" scope="col">Method</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#processControlMessage(com.linkedin.venice.kafka.protocol.ControlMessage,int,com.linkedin.davinci.kafka.consumer.PartitionConsumptionState,int)">processControlMessage</a></span>&#8203;(<a href="../../../venice/kafka/protocol/ControlMessage.html" title="class in com.linkedin.venice.kafka.protocol">ControlMessage</a>&nbsp;controlMessage,
                     int&nbsp;partition,
                     <a href="../../kafka/consumer/PartitionConsumptionState.html" title="class in com.linkedin.davinci.kafka.consumer">PartitionConsumptionState</a>&nbsp;partitionConsumptionState,
                     int&nbsp;version)</code></th>
<td class="colLast">
<div class="block">Called when the server encounters a control message.</div>
</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code>java.util.concurrent.CompletableFuture&lt;<a href="../../../venice/pubsub/api/PubSubProduceResult.html" title="interface in com.linkedin.venice.pubsub.api">PubSubProduceResult</a>&gt;</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#processRecord(java.nio.ByteBuffer,java.nio.ByteBuffer,byte%5B%5D,int,int,int,org.apache.avro.generic.GenericRecord)">processRecord</a></span>&#8203;(java.nio.ByteBuffer&nbsp;newValue,
             java.nio.ByteBuffer&nbsp;oldValue,
             byte[]&nbsp;key,
             int&nbsp;version,
             int&nbsp;newValueSchemaId,
             int&nbsp;oldValueSchemaId,
             org.apache.avro.generic.GenericRecord&nbsp;replicationMetadataRecord)</code></th>
<td class="colLast">
<div class="block">To be called as a given ingestion task consumes each record.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a id="methods.inherited.from.class.com.linkedin.venice.views.VeniceView">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;com.linkedin.venice.views.<a href="../../../venice/views/VeniceView.html" title="class in com.linkedin.venice.views">VeniceView</a></h3>
<code><a href="../../../venice/views/VeniceView.html#close()">close</a>, <a href="../../../venice/views/VeniceView.html#getTopicNamesAndConfigsForVersion(int)">getTopicNamesAndConfigsForVersion</a>, <a href="../../../venice/views/VeniceView.html#getWriterClassName()">getWriterClassName</a>, <a href="../../../venice/views/VeniceView.html#isViewTopic(java.lang.String)">isViewTopic</a>, <a href="../../../venice/views/VeniceView.html#parseStoreFromViewTopic(java.lang.String)">parseStoreFromViewTopic</a>, <a href="../../../venice/views/VeniceView.html#parseVersionFromViewTopic(java.lang.String)">parseVersionFromViewTopic</a>, <a href="../../../venice/views/VeniceView.html#validateConfigs()">validateConfigs</a></code></li>
</ul>
<ul class="blockList">
<li class="blockList"><a id="methods.inherited.from.class.java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.Object</h3>
<code>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</code></li>
</ul>
</li>
</ul>
</section>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<section>
<ul class="blockList">
<li class="blockList"><a id="constructor.detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a id="&lt;init&gt;(com.linkedin.davinci.config.VeniceConfigLoader,com.linkedin.venice.meta.Store,org.apache.avro.Schema,java.util.Map)">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>VeniceViewWriter</h4>
<pre>public&nbsp;VeniceViewWriter&#8203;(<a href="../../config/VeniceConfigLoader.html" title="class in com.linkedin.davinci.config">VeniceConfigLoader</a>&nbsp;props,
                        <a href="../../../venice/meta/Store.html" title="interface in com.linkedin.venice.meta">Store</a>&nbsp;store,
                        org.apache.avro.Schema&nbsp;keySchema,
                        java.util.Map&lt;java.lang.String,&#8203;java.lang.String&gt;&nbsp;extraViewParameters)</pre>
</li>
</ul>
</li>
</ul>
</section>
<!-- ============ METHOD DETAIL ========== -->
<section>
<ul class="blockList">
<li class="blockList"><a id="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a id="processRecord(java.nio.ByteBuffer,java.nio.ByteBuffer,byte[],int,int,int,org.apache.avro.generic.GenericRecord)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>processRecord</h4>
<pre class="methodSignature">public&nbsp;java.util.concurrent.CompletableFuture&lt;<a href="../../../venice/pubsub/api/PubSubProduceResult.html" title="interface in com.linkedin.venice.pubsub.api">PubSubProduceResult</a>&gt;&nbsp;processRecord&#8203;(java.nio.ByteBuffer&nbsp;newValue,
                                                                                 java.nio.ByteBuffer&nbsp;oldValue,
                                                                                 byte[]&nbsp;key,
                                                                                 int&nbsp;version,
                                                                                 int&nbsp;newValueSchemaId,
                                                                                 int&nbsp;oldValueSchemaId,
                                                                                 org.apache.avro.generic.GenericRecord&nbsp;replicationMetadataRecord)</pre>
<div class="block">To be called as a given ingestion task consumes each record. This is called prior to writing to a
 VT or to persistent storage.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>newValue</code> - the incoming fully specified value which hasn't yet been committed to Venice</dd>
<dd><code>oldValue</code> - the previous value which has already been locally committed to Venice for the given key</dd>
<dd><code>key</code> - the key of the record that designates newValue and oldValue</dd>
<dd><code>version</code> - the version of the store taking this record</dd>
<dd><code>newValueSchemaId</code> - the schemaId of the incoming record</dd>
<dd><code>oldValueSchemaId</code> - the schemaId of the old record</dd>
<dd><code>replicationMetadataRecord</code> - the associated RMD for the incoming record.</dd>
</dl>
</li>
</ul>
<a id="processControlMessage(com.linkedin.venice.kafka.protocol.ControlMessage,int,com.linkedin.davinci.kafka.consumer.PartitionConsumptionState,int)">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>processControlMessage</h4>
<pre class="methodSignature">public&nbsp;void&nbsp;processControlMessage&#8203;(<a href="../../../venice/kafka/protocol/ControlMessage.html" title="class in com.linkedin.venice.kafka.protocol">ControlMessage</a>&nbsp;controlMessage,
                                  int&nbsp;partition,
                                  <a href="../../kafka/consumer/PartitionConsumptionState.html" title="class in com.linkedin.davinci.kafka.consumer">PartitionConsumptionState</a>&nbsp;partitionConsumptionState,
                                  int&nbsp;version)</pre>
<div class="block">Called when the server encounters a control message. There isn't (today) a strict ordering
 on if the rest of the server alters it's state completely or not based on the incoming control message
 relative to the given view.

 TODO: Today this is only invoked for VERSION_SWAP control message, but we
 may in the future call this method for all control messages so that certain
 view types can act accordingly.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>controlMessage</code> - the control message we're processing</dd>
<dd><code>partition</code> - the partition this control message was delivered to</dd>
<dd><code>partitionConsumptionState</code> - the pcs of the consuming node</dd>
<dd><code>version</code> - the store version that received this message</dd>
</dl>
</li>
</ul>
</li>
</ul>
</section>
</li>
</ul>
</div>
</div>
</main>
<!-- ========= END OF CLASS DATA ========= -->
<footer role="contentinfo">
<nav role="navigation">
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a id="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a id="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../../allclasses.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a id="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</nav>
</footer>
</body>
</html>
